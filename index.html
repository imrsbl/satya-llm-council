<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satya - AI LLM Council</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Password Protection Overlay - Compact Mobile-First Design -->
    <div id="login-overlay" style="
        position: fixed;
        inset: 0;
        background: #0a0a0f;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
    ">
        <div style="width: 100%; max-width: 280px; padding: 16px; text-align: center;">
            <!-- Logo -->
            <img src="logo.png"
                style="width: 64px; height: 64px; border-radius: 12px; margin-bottom: 12px; object-fit: cover;">
            <h2 style="color: #fff; font-size: 20px; margin: 0 0 4px; font-family: Inter, sans-serif;">Satya</h2>
            <p style="color: #666; font-size: 12px; margin: 0 0 16px; font-family: Inter, sans-serif;">Enter password to
                continue</p>

            <!-- Password Input -->
            <input type="password" id="login-password" placeholder="Password" style="
                width: 100%; padding: 12px; background: #1a1a20; border: 1px solid #333;
                border-radius: 10px; color: #fff; font-size: 15px; font-family: Inter, sans-serif;
                outline: none; margin-bottom: 10px; box-sizing: border-box;
            " onkeypress="if(event.key==='Enter') attemptLogin()">

            <!-- API Key Input (always visible now for simplicity) -->
            <input type="text" id="login-api-key" placeholder="API Key (sk-or-v1-...)" style="
                width: 100%; padding: 10px; background: #1a1a20; border: 1px solid #333;
                border-radius: 10px; color: #0f8; font-size: 12px; font-family: monospace;
                outline: none; margin-bottom: 12px; box-sizing: border-box;
            ">

            <!-- Unlock Button -->
            <button onclick="attemptLogin()" style="
                width: 100%; padding: 12px; background: #00DDB3; border: none;
                border-radius: 20px; color: #000; font-size: 15px; font-weight: 600;
                font-family: Inter, sans-serif; cursor: pointer;
            ">Unlock</button>

            <p id="login-error"
                style="color: #f44; font-size: 11px; margin: 8px 0 0; display: none; font-family: Inter, sans-serif;">
                Incorrect password</p>
        </div>
    </div>

    <script>
        // Check if already authenticated
        (function () {
            const authKey = localStorage.getItem('satya_auth');
            if (authKey === 'authenticated') {
                document.getElementById('login-overlay').style.display = 'none';
            }
            // Pre-fill API key if stored
            const storedKey = localStorage.getItem('satya_api_key');
            if (storedKey) {
                document.getElementById('login-api-key').value = storedKey;
            }
        })();

        function attemptLogin() {
            const password = document.getElementById('login-password').value;
            const apiKey = document.getElementById('login-api-key').value.trim();

            if (password === 'satya2026') {
                localStorage.setItem('satya_auth', 'authenticated');
                if (apiKey) {
                    localStorage.setItem('satya_api_key', apiKey);
                }
                document.getElementById('login-overlay').style.display = 'none';
            } else {
                document.getElementById('login-error').style.display = 'block';
                document.getElementById('login-password').value = '';
            }
        }
    </script>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <img src="logo.png" class="logo-img">
                <span class="logo-text">Satya</span>
            </div>
            <nav class="nav-tabs">
                <button class="nav-tab" data-tab="superchat">
                    <svg class="mode-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    Super Chat
                </button>
                <button class="nav-tab active" data-tab="council">
                    <svg class="mode-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M8 12h8"></path>
                        <path d="M12 8v8"></path>
                    </svg>
                    Council
                </button>
                <button class="nav-tab" data-tab="dxo">
                    <svg class="mode-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    DxO
                </button>
                <button class="nav-tab" data-tab="ensemble">
                    <svg class="mode-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <polyline points="16 3 21 3 21 8"></polyline>
                        <line x1="4" y1="20" x2="21" y2="3"></line>
                        <polyline points="21 16 21 21 16 21"></polyline>
                        <line x1="15" y1="15" x2="21" y2="21"></line>
                        <polyline points="8 21 3 21 3 16"></polyline>
                        <line x1="3" y1="21" x2="9" y2="15"></line>
                    </svg>
                    Ensemble
                </button>
                <button class="nav-tab" data-tab="benchmarks">
                    <svg class="mode-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                        <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                        <path d="M4 22h16"></path>
                        <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                        <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                        <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
                    </svg>
                    Benchmarks
                </button>
                <button class="nav-tab" data-tab="leaderboard">
                    <svg class="mode-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M12 20V10"></path>
                        <path d="M18 20V4"></path>
                        <path d="M6 20v-4"></path>
                    </svg>
                    Leaderboard
                </button>
            </nav>
        </div>
        <div class="header-right">
            <div class="ultra-mode-container" title="Top Benchmarked Free Models">
                <button class="toggle-switch ultra-toggle" id="ultra-mode-toggle" onclick="toggleUltraFreeMode()">
                    <div class="toggle-dot"></div>
                </button>
                <span class="mode-label">Ultra Free</span>
            </div>
            <button class="header-btn" onclick="showHistory()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12,6 12,12 16,14"></polyline>
                </svg>
                History
            </button>
            <button class="header-btn" onclick="showSettings()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                    </path>
                </svg>
                Settings
            </button>
            <button class="header-btn logout-btn" onclick="logout()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Logout
            </button>
            <!-- Mobile Hamburger Menu Button -->
            <button class="mobile-menu-btn" id="mobile-menu-btn" onclick="toggleMobileMenu()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
        </div>
        <!-- Mobile Menu Dropdown -->
        <div class="mobile-menu-dropdown" id="mobile-menu-dropdown">
            <button class="mobile-menu-item" onclick="showHistory(); closeMobileMenu();">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12,6 12,12 16,14"></polyline>
                </svg>
                History
            </button>
            <button class="mobile-menu-item" onclick="showSettings(); closeMobileMenu();">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c.26.604.852.997 1.51 1H21a2 2 0 0 1 0 4h-.09c-.658.003-1.25.396-1.51 1z">
                    </path>
                </svg>
                Settings
            </button>
            <button class="mobile-menu-item logout" onclick="logout(); closeMobileMenu();">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Logout
            </button>
        </div>
    </header>

    <!-- Fullscreen Reader Overlay (double-tap to open/close) -->
    <div id="fullscreen-reader" class="fullscreen-reader hidden" ondblclick="closeFullscreenReader()">
        <button class="fullscreen-close-btn" onclick="closeFullscreenReader()">√ó</button>
        <div class="fullscreen-content" id="fullscreen-content"></div>
        <div class="fullscreen-hint">Double-tap to close</div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Council Mode -->
        <section id="council-page" class="page active">
            <div class="page-badge purple">
                <span>‚ö°</span> Karpathy Pattern Implementation
            </div>
            <h1 class="page-title">AI LLM Council</h1>
            <p class="page-description">
                Send your prompt to multiple AI models simultaneously. Watch them deliberate, critique each other, and
                synthesize the best response through a Chairman model.
            </p>

            <div class="card prompt-card">
                <label class="card-label">Research Prompt</label>
                <div class="input-wrapper">
                    <textarea id="council-prompt" class="prompt-input"
                        placeholder="Enter your research question or topic... e.g., 'What are the pros and cons of different database architectures for a high-traffic e-commerce platform?'"></textarea>
                    <div class="input-actions">
                        <button class="upload-btn" onclick="triggerUpload('council')" title="Upload Image/Document">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                                </path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div id="council-attachments" class="attachments-preview"></div>
                <div class="quick-prompts">
                    <span class="quick-label">Try these:</span>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('council', 'Deep analysis of Ethereum\'s Dencun upgrade impact on L2 scaling, transaction costs, and network decentralization in 2026.')">‚ö°
                        Ethereum Dencun Hub</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('council', 'Compare the tokenomics, inflation models, and ecosystem incentives of Solana vs. Sui. Which protocol is better positioned for institutional adoption?')">ÔøΩ
                        L1 Comparison</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('council', 'Analyze the potential impact of a Bitcoin spot ETF options approval on market volatility and retail liquidity over a 12-month horizon.')">üìà
                        ETF Volatility</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('council', 'Audit this smart contract logic for common vulnerabilities (reentrancy, integer overflow, flash loan attacks): [Paste code snippet here]')">üõ°Ô∏è
                        Security Audit</button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <label class="card-label">Council Members</label>
                    <span class="card-hint">Select 2+ models for best results</span>
                </div>

                <!-- Search & Filter Bar -->
                <div class="model-filter-bar">
                    <div class="search-wrapper">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="M21 21l-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="council-model-search" class="model-search" placeholder="Search models..."
                            oninput="filterCouncilModels()">
                    </div>
                    <div class="filter-chips">
                        <button class="filter-chip" data-filter="Reasoning"
                            onclick="toggleFilter('council', 'Reasoning', this)">üß† Reasoning</button>
                        <button class="filter-chip" data-filter="Coding"
                            onclick="toggleFilter('council', 'Coding', this)">üíª Coding</button>
                        <button class="filter-chip" data-filter="Fast" onclick="toggleFilter('council', 'Fast', this)">‚ö°
                            Fast</button>
                        <button class="filter-chip" data-filter="Multimodal"
                            onclick="toggleFilter('council', 'Multimodal', this)">üñºÔ∏è Multimodal</button>
                    </div>
                </div>

                <!-- Selection Counter -->
                <div class="selection-counter" id="council-selection-counter">
                    <span class="counter-text"><strong id="council-selected-count">3</strong> models selected</span>
                    <div class="counter-badges">
                        <span class="speed-badge" id="council-speed-badge">‚ö° Fast</span>
                        <span class="cost-badge" id="council-cost-badge">üí∞ Free</span>
                    </div>
                </div>

                <div class="model-grid" id="council-models">
                    <!-- Models will be rendered here -->
                </div>

                <!-- Preset Controls -->
                <div class="preset-controls">
                    <button class="preset-btn save-preset" onclick="savePreset('council')">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                        Save Setup
                    </button>
                    <div class="preset-dropdown-wrapper">
                        <select id="council-preset-select" class="preset-dropdown"
                            onchange="loadPreset('council', this.value)">
                            <option value="">Load Preset...</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="card settings-card">
                <div class="settings-grid">
                    <div class="setting-item">
                        <div class="setting-header">
                            <label class="card-label">Rounds</label>
                            <span class="card-hint-inline" id="council-rounds-label">1 Round</span>
                        </div>
                        <input type="range" id="council-rounds" min="1" max="5" value="1" class="mode-slider"
                            oninput="document.getElementById('council-rounds-label').textContent = this.value + (this.value == 1 ? ' Round' : ' Rounds')">
                    </div>
                    <div class="setting-item">
                        <div class="setting-header">
                            <label class="card-label">Peer Ranking</label>
                            <button class="toggle-switch active" id="council-peer-ranking-toggle"
                                onclick="this.classList.toggle('active')">
                                <div class="toggle-dot"></div>
                            </button>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-header">
                            <label class="card-label">Chairman</label>
                            <span class="card-hint-inline">Synthesizer</span>
                        </div>
                        <select id="chairman-select" class="model-select"></select>
                    </div>
                </div>
            </div>

            <button class="primary-btn" onclick="startCouncil()">
                Start Research <span class="btn-arrow">‚Üí</span>
            </button>
        </section>

        <!-- DxO Mode -->
        <section id="dxo-page" class="page">
            <div class="page-badge pink">
                <span>üé≠</span> Role-Based Orchestration
            </div>
            <h1 class="page-title dxo-title">DxO Decision Orchestrator</h1>
            <p class="page-description">
                Inspired by Microsoft's MAI-DxO research. Assign different AI models to specialized roles for
                collaborative decision-making, research synthesis, and problem-solving.
            </p>

            <div class="card prompt-card">
                <label class="card-label">Problem Statement or Research Question</label>
                <div class="input-wrapper">
                    <textarea id="dxo-prompt" class="prompt-input"
                        placeholder="Describe your decision problem, research question, or topic that needs multi-perspective analysis..."></textarea>
                    <div class="input-actions">
                        <button class="upload-btn" onclick="triggerUpload('dxo')" title="Upload Image/Document">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                                </path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div id="dxo-attachments" class="attachments-preview"></div>
                <div class="quick-prompts">
                    <span class="quick-label">Try these:</span>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('dxo', 'Perform a full risk/reward analysis for providing liquidity to a new V3 Uniswap pool on Arbitrum. Consider IL, fee tier optimization, and volume volatility.')">ü¶Ñ
                        Uniswap V3 LP</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('dxo', 'Assess the long-term viability of modular blockchains (Celestia, Avail) vs. integrated chains (Solana, Monad). Focus on cost, security, and developer UX.')">üß±
                        Modular vs Integrated</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('dxo', 'Design a governance model for a decentralized protocol that prevents whale capture while maintaining efficient decision-making speeds.')">üó≥Ô∏è
                        Governance Design</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('dxo', 'Analyze the potential for institutional RWA (Real World Asset) tokenization on public vs. private blockchains over the next 3 years.')">ÔøΩ
                        RWA Outlook</button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <label class="card-label">Role Assignments</label>
                    <button class="add-role-btn" onclick="addRole()">+ Add Role</button>
                </div>
                <p class="card-subtitle">Assign AI models to specialized roles. Each role brings a unique perspective.
                </p>
                <div id="role-assignments">
                    <!-- Roles will be rendered here -->
                </div>
            </div>

            <div class="quick-templates">
                <span class="quick-label">Quick Templates</span>
                <button class="template-chip" onclick="loadTemplate('crypto_analysis')">
                    <span>‚Çø</span> Crypto Research
                </button>
                <button class="template-chip" onclick="loadTemplate('defi_audit')">
                    <span>ÔøΩÔ∏è</span> DeFi Audit
                </button>
                <button class="template-chip" onclick="loadTemplate('technical')">
                    <span>üíª</span> Tech Review
                </button>
                <button class="template-chip" onclick="loadTemplate('strategic')">
                    <span>üéØ</span> Strategic
                </button>
                <button class="template-chip" onclick="loadTemplate('creative')">
                    <span>üíé</span> Creative
                </button>
            </div>

            <div class="card settings-card">
                <div class="settings-grid">
                    <div class="setting-item">
                        <div class="setting-header">
                            <label class="card-label">Rounds</label>
                            <span class="card-hint-inline" id="dxo-rounds-label">1 Round</span>
                        </div>
                        <input type="range" id="dxo-rounds" min="1" max="5" value="1" class="mode-slider"
                            oninput="document.getElementById('dxo-rounds-label').textContent = this.value + (this.value == 1 ? ' Round' : ' Rounds')">
                    </div>
                </div>
            </div>

            <button class="primary-btn" onclick="startDxO()">
                Start Analysis <span class="btn-arrow">‚Üí</span>
            </button>
        </section>

        <!-- Ensemble Mode -->
        <section id="ensemble-page" class="page">
            <div class="page-badge green">
                <span>üîÆ</span> Anonymous Collective Intelligence
            </div>
            <h1 class="page-title ensemble-title">Ensemble</h1>
            <p class="page-description">
                Inspired by AI Council MCP. Query multiple AI models simultaneously, anonymize their responses with code
                names, then synthesize the best answer without brand bias.
            </p>

            <div class="process-steps">
                <div class="process-step">
                    <div class="step-number">1</div>
                    <h3>Parallel Query</h3>
                    <p>All models receive your question simultaneously</p>
                </div>
                <div class="process-step">
                    <div class="step-number">2</div>
                    <h3>Anonymize</h3>
                    <p>Responses get code names (Alpha, Beta, etc.)</p>
                </div>
                <div class="process-step">
                    <div class="step-number">3</div>
                    <h3>Synthesize</h3>
                    <p>Unbiased synthesis of best insights</p>
                </div>
            </div>

            <div class="card prompt-card">
                <label class="card-label">Your Question or Topic</label>
                <div class="input-wrapper">
                    <textarea id="ensemble-prompt" class="prompt-input"
                        placeholder="Ask anything - the ensemble will provide multiple perspectives and synthesize the best answer..."></textarea>
                    <div class="input-actions">
                        <button class="upload-btn" onclick="triggerUpload('ensemble')" title="Upload Image/Document">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                                </path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div id="ensemble-attachments" class="attachments-preview"></div>
                <div class="quick-prompts">
                    <span class="quick-label">Try these:</span>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('ensemble', 'What is the most likely regulatory outcome for stablecoins in the US and EU by late 2026? Synthesize views from multiple experts.')">‚öñÔ∏è
                        Regulatory Outlook</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('ensemble', 'Evaluate the technical feasibility and market impact of Liquid Staking Tokens (LSTs) on networks like Bitcoin or Solana. Which will dominate?')">ÔøΩ
                        LST Impact</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('ensemble', 'Analyze the Bitcoin halving impact on miner profitability and hash rate security under different price scenarios ($50k, $100k, $150k).')">‚õèÔ∏è
                        Halving Math</button>
                    <button class="quick-chip example-prompt"
                        onclick="setPrompt('ensemble', 'Synthesize the current state of Zero-Knowledge proofs (zk-Rollups vs Optimistic) and their adoption in the Ethereum ecosystem.')">ü§´
                        ZK-Proofs</button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <label class="card-label">Ensemble Members</label>
                    <span class="card-hint" id="ensemble-count">3 selected</span>
                </div>

                <!-- Search & Filter Bar -->
                <div class="model-filter-bar">
                    <div class="search-wrapper">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="M21 21l-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="ensemble-model-search" class="model-search"
                            placeholder="Search models..." oninput="filterEnsembleModels()">
                    </div>
                    <div class="filter-chips">
                        <button class="filter-chip" data-filter="Reasoning"
                            onclick="toggleFilter('ensemble', 'Reasoning', this)">üß† Reasoning</button>
                        <button class="filter-chip" data-filter="Coding"
                            onclick="toggleFilter('ensemble', 'Coding', this)">üíª Coding</button>
                        <button class="filter-chip" data-filter="Fast"
                            onclick="toggleFilter('ensemble', 'Fast', this)">‚ö° Fast</button>
                        <button class="filter-chip" data-filter="Multimodal"
                            onclick="toggleFilter('ensemble', 'Multimodal', this)">üñºÔ∏è Multimodal</button>
                    </div>
                </div>

                <!-- Selection Counter -->
                <div class="selection-counter" id="ensemble-selection-counter">
                    <span class="counter-text"><strong id="ensemble-selected-count">3</strong> models selected</span>
                    <div class="counter-badges">
                        <span class="speed-badge" id="ensemble-speed-badge">‚ö° Fast</span>
                        <span class="cost-badge" id="ensemble-cost-badge">üí∞ Free</span>
                    </div>
                </div>

                <div class="model-grid" id="ensemble-models">
                    <!-- Models will be rendered here -->
                </div>

                <!-- Preset Controls -->
                <div class="preset-controls">
                    <button class="preset-btn save-preset" onclick="savePreset('ensemble')">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                        Save Setup
                    </button>
                    <div class="preset-dropdown-wrapper">
                        <select id="ensemble-preset-select" class="preset-dropdown"
                            onchange="loadPreset('ensemble', this.value)">
                            <option value="">Load Preset...</option>
                        </select>
                    </div>
                </div>
                <div class="card settings-card">
                    <div class="settings-grid">
                        <div class="setting-item">
                            <div class="setting-header">
                                <label class="card-label">Rounds</label>
                                <span class="card-hint-inline" id="ensemble-rounds-label">1 Round</span>
                            </div>
                            <input type="range" id="ensemble-rounds" min="1" max="5" value="1" class="mode-slider"
                                oninput="document.getElementById('ensemble-rounds-label').textContent = this.value + (this.value == 1 ? ' Round' : ' Rounds')">
                        </div>
                    </div>
                </div>

                <button class="primary-btn ensemble-btn" onclick="startEnsemble()">
                    Start Ensemble <span class="btn-arrow">‚Üí</span>
                </button>
        </section>

        <!-- Super Chat Mode -->
        <section id="superchat-page" class="page">
            <div class="page-badge blue">
                <span>üí¨</span> Direct Model Chat
            </div>
            <h1 class="page-title">Super Chat</h1>
            <p class="page-description">
                Chat directly with a single AI model of your choice. Simple, fast, and focused conversations.
            </p>

            <div class="card">
                <label class="card-label">Select Model</label>
                <select id="superchat-model" class="model-select">
                    <!-- Options will be hydrated by JS based on Free Mode -->
                </select>
            </div>

            <div class="card prompt-card">
                <label class="card-label">Your Message</label>
                <div class="input-wrapper">
                    <textarea id="superchat-prompt" class="prompt-input" placeholder="Type your message..."></textarea>
                    <div class="input-actions">
                        <button class="upload-btn" onclick="triggerUpload('superchat')" title="Upload Image/Document">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                                </path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div id="superchat-attachments" class="attachments-preview"></div>
            </div>

            <button class="primary-btn" onclick="startSuperChat()">
                Send Message <span class="btn-arrow">‚Üí</span>
            </button>
        </section>

        <!-- Benchmarks Mode -->
        <section id="benchmarks-page" class="page">
            <div class="page-badge orange">
                <span>üèÜ</span> AI Model Benchmarking
            </div>
            <h1 class="page-title benchmarks-title">Benchmarks</h1>
            <p class="page-description">
                Test your council or ensemble setup against predefined challenging problems.
                Automatic scoring for coherence, accuracy, and collaboration quality.
            </p>

            <div class="card">
                <div class="card-header">
                    <label class="card-label">Select Benchmark Test</label>
                    <span class="card-hint">Choose a challenge to evaluate AI performance</span>
                </div>
                <div class="benchmark-grid">
                    <div class="benchmark-card" onclick="selectBenchmark('blue-eyed')" data-benchmark="blue-eyed">
                        <div class="benchmark-icon">üß©</div>
                        <div class="benchmark-info">
                            <h4>Blue-Eyed Islanders</h4>
                            <p>Classic logic puzzle testing step-by-step reasoning</p>
                            <span class="difficulty hard">Hard</span>
                        </div>
                    </div>
                    <div class="benchmark-card" onclick="selectBenchmark('three-gods')" data-benchmark="three-gods">
                        <div class="benchmark-icon">üîÆ</div>
                        <div class="benchmark-info">
                            <h4>Three Gods Puzzle</h4>
                            <p>Determine which god is which with 3 questions</p>
                            <span class="difficulty hard">Hard</span>
                        </div>
                    </div>
                    <div class="benchmark-card" onclick="selectBenchmark('coding')" data-benchmark="coding">
                        <div class="benchmark-icon">üíª</div>
                        <div class="benchmark-info">
                            <h4>Coding Challenge</h4>
                            <p>Implement Manacher's algorithm for palindromes</p>
                            <span class="difficulty medium">Medium</span>
                        </div>
                    </div>
                    <div class="benchmark-card" onclick="selectBenchmark('debate')" data-benchmark="debate">
                        <div class="benchmark-icon">‚öñÔ∏è</div>
                        <div class="benchmark-info">
                            <h4>AI Ethics Debate</h4>
                            <p>Nuanced discussion of AI in critical decisions</p>
                            <span class="difficulty medium">Medium</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <label class="card-label">Setup Configuration</label>
                <div class="benchmark-config">
                    <div class="config-option">
                        <label>Mode</label>
                        <select id="benchmark-mode" class="model-select">
                            <option value="council">Council (with Chairman)</option>
                            <option value="ensemble">Ensemble (Anonymous)</option>
                        </select>
                    </div>
                    <div class="config-option">
                        <label>Use Current Selection</label>
                        <button class="toggle-switch active" id="use-current-selection"
                            onclick="toggleBenchmarkSelection()">
                            <div class="toggle-dot"></div>
                        </button>
                    </div>
                </div>
            </div>

            <div id="benchmark-selected" class="benchmark-selected hidden">
                <div class="selected-test-badge">
                    <span id="selected-benchmark-icon">üß©</span>
                    <span id="selected-benchmark-name">Blue-Eyed Islanders</span>
                </div>
            </div>

            <button class="primary-btn benchmark-btn" onclick="startBenchmark()">
                Run Benchmark <span class="btn-arrow">‚Üí</span>
            </button>
        </section>

        <!-- Results Panel (Hidden by default) -->
        <section id="results-panel" class="results-panel hidden">
            <div class="results-header">
                <h2 id="results-title">Council Deliberation</h2>
                <div class="results-actions">
                    <button class="results-action-btn continue-btn" id="continue-session-btn"
                        onclick="continueSession()" title="Continue with context">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        Continue
                    </button>
                    <button class="results-action-btn" onclick="copyAllResults()" title="Copy All">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        Copy
                    </button>
                    <div class="export-dropdown-wrapper">
                        <button class="results-action-btn export-dropdown-btn" onclick="toggleExportMenu()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Export
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M6 9l6 6 6-6"></path>
                            </svg>
                        </button>
                        <div class="export-menu hidden" id="export-menu">
                            <button onclick="exportCurrentResults()">üìÑ Markdown</button>
                            <button onclick="exportAsPDF()">üìë PDF</button>
                            <button onclick="sendToNotion()">üöÄ Send to Notion</button>
                            <button onclick="generateShareableLink()">üîó Share Link</button>
                        </div>
                    </div>
                    <button class="close-btn" onclick="closeResults()">√ó</button>
                </div>
            </div>
            <div class="results-content">
                <div id="model-responses" class="model-responses">
                    <!-- Individual model responses -->
                </div>
                <div id="peer-rankings-container" class="peer-rankings hidden">
                    <div class="card-header">
                        <label class="card-label">Peer Rankings & Critique</label>
                        <span class="card-hint">Models ranking each other</span>
                    </div>
                    <div id="peer-rankings-content"></div>
                </div>

                <div id="synthesis-panel" class="synthesis-panel hidden">
                    <h3>
                        <span class="synthesis-icon">‚ú®</span>
                        Final Synthesis
                    </h3>
                    <div id="synthesis-content" class="synthesis-content"></div>
                </div>

                <div class="session-meta-card">
                    <div class="card-header">
                        <label class="card-label">Session Metadata</label>
                        <span class="card-hint">Tag this research for later filtering</span>
                    </div>
                    <div class="meta-inputs">
                        <div class="meta-field">
                            <label>Research Tags (comma separated)</label>
                            <input type="text" id="session-tags" placeholder="e.g. eth, de-fi, scaling, risk-analysis">
                        </div>
                        <div class="meta-field">
                            <label>Researcher Notes</label>
                            <textarea id="session-notes" placeholder="Key takeaways or follow-up items..."></textarea>
                        </div>
                        <button class="primary-btn save-meta-btn" onclick="saveSessionMeta()">
                            üíæ Save Research Notes
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Leaderboard Page -->
        <section id="leaderboard-page" class="page hidden">
            <div class="page-badge orange">
                <span>üèÜ</span> Model Performance Leaderboard
            </div>
            <h1 class="page-title">Personal Leaderboard</h1>
            <p class="page-description">
                Tracking win rates, rankings, and performance of all council members over time based on your research
                sessions.
            </p>

            <div class="leaderboard-filters">
                <div class="filter-group">
                    <label>Filter by Research Tag</label>
                    <div class="tag-filter-wrapper">
                        <input type="text" id="leaderboard-tag-filter" placeholder="e.g. eth, security"
                            oninput="renderLeaderboard()">
                    </div>
                </div>
                <div class="leaderboard-stats-summary">
                    <div class="summary-box">
                        <span class="label">Total Sessions</span>
                        <span class="value" id="lb-total-sessions">0</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <label class="card-label">Top Performers</label>
                </div>
                <div id="leaderboard-content">
                    <table class="leaderboard-table" id="leaderboard-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Model</th>
                                <th>Win Rate</th>
                                <th>Top Pick %</th>
                                <th>Sessions</th>
                            </tr>
                        </thead>
                        <tbody id="leaderboard-body">
                            <!-- Data rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- History Modal -->
        <div id="history-modal" class="modal hidden">
            <div class="modal-content history-modal">
                <div class="modal-header">
                    <h2>Research History</h2>
                    <button class="close-btn" onclick="closeHistory()">√ó</button>
                </div>
                <div class="history-actions">
                    <button class="action-chip purple" onclick="filterHistory('superchat')" data-mode="superchat">+
                        Super Chat</button>
                    <button class="action-chip purple" onclick="filterHistory('council')" data-mode="council">+
                        Council</button>
                    <button class="action-chip pink" onclick="filterHistory('dxo')" data-mode="dxo">+ DxO</button>
                    <button class="action-chip green" onclick="filterHistory('ensemble')" data-mode="ensemble">+
                        Ensemble</button>
                    <button class="action-chip" onclick="filterHistory(null)"
                        style="background: rgba(255,255,255,0.1);">Show All</button>
                </div>
                <div class="history-stats">
                    <div class="stat-box">
                        <span class="stat-label">Total</span>
                        <span class="stat-value" id="stat-total">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Super Chat</span>
                        <span class="stat-value blue" id="stat-superchat">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Council</span>
                        <span class="stat-value purple" id="stat-council">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">DxO</span>
                        <span class="stat-value pink" id="stat-dxo">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Ensemble</span>
                        <span class="stat-value green" id="stat-ensemble">0</span>
                    </div>
                </div>
                <div id="history-list" class="history-list">
                    <!-- History items will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content settings-modal">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button class="close-btn" onclick="closeSettings()">√ó</button>
                </div>
                <div class="settings-content">
                    <div class="setting-group">
                        <label class="setting-label">OpenRouter API Key</label>
                        <input type="password" id="api-key-input" class="setting-input" placeholder="sk-or-v1-..."
                            value="">
                        <p class="setting-hint">Your API key is stored locally in your browser.</p>
                    </div>

                    <div class="setting-group">
                        <div class="setting-header">
                            <label class="setting-label">Local LLM Support</label>
                            <button class="toggle-switch" id="local-llm-toggle"
                                onclick="this.classList.toggle('active')">
                                <div class="toggle-dot"></div>
                            </button>
                        </div>
                        <div class="local-endpoint-group">
                            <label class="card-label">Endpoint URL</label>
                            <input type="text" id="local-endpoint-input" class="setting-input"
                                placeholder="http://localhost:11434/v1" value="http://localhost:11434/v1">
                            <p class="setting-hint">Supports Ollama (port 11434) or LM Studio (port 1234).</p>
                        </div>
                    </div>
                    <div class="setting-group">
                        <label class="setting-label">Notion Integration (Export)</label>
                        <div class="notion-settings-grid" style="display: grid; gap: 10px; margin-top: 10px;">
                            <div>
                                <label class="card-label">Notion API Key</label>
                                <input type="password" id="notion-api-key" class="setting-input"
                                    placeholder="secret_...">
                            </div>
                            <div>
                                <label class="card-label">Notion Database ID</label>
                                <input type="text" id="notion-db-id" class="setting-input" placeholder="32-char ID">
                            </div>
                        </div>
                        <p class="setting-hint">Create an integration at developers.notion.com and share your database
                            with it.</p>
                    </div>
                    <button class="primary-btn" onclick="saveSettings()">Save Settings</button>
                </div>
            </div>
        </div>
    </main>

    <script src="app.js"></script>
</body>

</html>